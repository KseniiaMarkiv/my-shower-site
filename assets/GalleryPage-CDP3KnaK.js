import{R as m,u as N,r as h,j as i}from"./index-iFSnuoG8.js";function x(o,n){if(o==null)return{};var e=P(o,n),t,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(o);for(r=0;r<s.length;r++)t=s[r],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(o,t)&&(e[t]=o[t])}return e}function P(o,n){if(o==null)return{};var e={},t=Object.keys(o),r,s;for(s=0;s<t.length;s++)r=t[s],!(n.indexOf(r)>=0)&&(e[r]=o[r]);return e}function d(){return d=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(o[t]=e[t])}return o},d.apply(this,arguments)}function g(o,n){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),e.push.apply(e,t)}return e}function p(o){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?g(Object(e),!0).forEach(function(t){k(o,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):g(Object(e)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(e,t))})}return o}function k(o,n,e){return n in o?Object.defineProperty(o,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[n]=e,o}const z={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},C=2;class w extends m.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||C,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||C});let t=1/0,r=e.default||C;for(let s in e){const l=parseInt(s);l>0&&n<=l&&l<t&&(t=l,r=e[s])}r=Math.max(1,parseInt(r)||1),this.state.columnCount!==r&&this.setState({columnCount:r})}itemsInColumns(){const n=this.state.columnCount,e=new Array(n),t=m.Children.toArray(this.props.children);for(let r=0;r<t.length;r++){const s=r%n;e[s]||(e[s]=[]),e[s].push(t[r])}return e}renderColumns(){const{column:n,columnAttrs:e={},columnClassName:t}=this.props,r=this.itemsInColumns(),s=`${100/r.length}%`;let l=t;l&&typeof l!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof l>"u"&&(l="my-masonry-grid_column"));const c=p(p(p({},n),e),{},{style:p(p({},e.style),{},{width:s}),className:l});return r.map((a,u)=>m.createElement("div",d({},c,{key:u}),a))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:e,breakpointCols:t,columnClassName:r,columnAttrs:s,column:l,className:c}=n,a=x(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let u=c;return typeof c!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof c>"u"&&(u="my-masonry-grid")),m.createElement("div",d({},a,{className:u}),this.renderColumns())}}w.defaultProps=z;function D(){const{slug:o}=N(),[n,e]=h.useState([]),[t,r]=h.useState(null);h.useEffect(()=>{const a=`gallery-${o}`,u=sessionStorage.getItem(a);if(u){e(JSON.parse(u));return}const _=`https://email-api-p7zg.onrender.com/api/gallery/${o}`;fetch(_).then(f=>f.json()).then(f=>{const y=[...f].sort((v,O)=>{const b=j=>j.public_id.split("/").pop().replace(/\.(jpg|jpeg|png|webm)$/,".mp4");return b(v).localeCompare(b(O))});sessionStorage.setItem(a,JSON.stringify(y)),e(y)}).catch(console.error)},[o]);const s=a=>r(a),l=()=>r(null),c={default:4,1200:4,992:3,768:2,576:1};return i.jsxs("div",{className:"container gallery-page pb-4",children:[i.jsx(w,{breakpointCols:c,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:n.map((a,u)=>i.jsx("div",{className:"gallery-item",onClick:()=>s(a),children:a.resource_type==="video"?i.jsxs("video",{className:"gallery-image shadow-sm",preload:"metadata",width:"100%",autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!1,disablePictureInPicture:!0,poster:`https://res.cloudinary.com/dyxzzhzqs/video/upload/f_auto,q_auto,w_600/${a.public_id}`,children:[i.jsx("source",{src:`https://res.cloudinary.com/dyxzzhzqs/video/upload/f_auto,q_auto,vc_auto,ac_none,w_600/${a.public_id}`,type:"video/mp4"}),"Your browser does not support the video tag."]}):i.jsx("img",{src:`https://res.cloudinary.com/dyxzzhzqs/image/upload/w_600,c_fill,f_auto,q_auto/${a.public_id}`,alt:a.public_id,className:"img-fluid shadow-sm gallery-image",loading:"lazy"})},u))}),t&&i.jsxs("div",{className:"fullscreen-overlay",onClick:a=>{a.target.classList.contains("fullscreen-overlay")&&l()},children:[i.jsx("button",{className:"close-button",onClick:l,children:"Ã—"}),t.resource_type==="video"?i.jsxs("video",{autoPlay:!0,muted:!0,loop:!0,playsInline:!0,controls:!0,className:"fullscreen-media",children:[i.jsx("source",{src:`https://res.cloudinary.com/dyxzzhzqs/video/upload/f_auto,q_auto,vc_auto,ac_none,w_1200/${t.public_id}`,type:"video/mp4"}),"Your browser does not support the video tag."]}):i.jsx("img",{src:`https://res.cloudinary.com/dyxzzhzqs/image/upload/f_auto,q_auto,w_1200/${t.public_id}`,alt:t.public_id,className:"fullscreen-media"})]})]})}export{D as default};
